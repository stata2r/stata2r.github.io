<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.33">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Code+Pro"><title>fixest | Stata2R</title><meta name="description" content="">
    <link rel="modulepreload" href="/assets/app.25be73f6.js"><link rel="modulepreload" href="/assets/index.html.017a3988.js"><link rel="modulepreload" href="/assets/index.html.a3260cd9.js">
    <link rel="stylesheet" href="/assets/style.3edb955c.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header ref_key="navbar" class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><!----><span class="site-name">Stata2R</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a class="external-link" href="https://github.com/stata2r/stata2r.github.io" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a class="external-link" href="https://github.com/stata2r/stata2r.github.io" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><a href="/data.table/" class="sidebar-item sidebar-heading" aria-label="data.table"><!--[--><!--]--> data.table <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/fixest/" class="router-link-active router-link-exact-active router-link-active sidebar-item sidebar-heading active" aria-label="fixest"><!--[--><!--]--> fixest <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/fixest/#installation" class="router-link-active router-link-exact-active sidebar-item" aria-label="Installation"><!--[--><!--]--> Installation <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/fixest/#introduction" class="router-link-active router-link-exact-active sidebar-item" aria-label="Introduction"><!--[--><!--]--> Introduction <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/fixest/#models" class="router-link-active router-link-exact-active sidebar-item" aria-label="Models"><!--[--><!--]--> Models <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/fixest/#interactions" class="router-link-active router-link-exact-active sidebar-item" aria-label="Interactions"><!--[--><!--]--> Interactions <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/fixest/#standard-errors" class="router-link-active router-link-exact-active sidebar-item" aria-label="Standard errors"><!--[--><!--]--> Standard errors <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/fixest/#presentation" class="router-link-active router-link-exact-active sidebar-item" aria-label="Presentation"><!--[--><!--]--> Presentation <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/fixest/#panel" class="router-link-active router-link-exact-active sidebar-item" aria-label="Panel"><!--[--><!--]--> Panel <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a href="/extras/" class="sidebar-item sidebar-heading" aria-label="extras"><!--[--><!--]--> extras <!--[--><!--]--></a><!----></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="regression-analysis-with-fixest" tabindex="-1"><a class="header-anchor" href="#regression-analysis-with-fixest" aria-hidden="true">#</a> Regression analysis with fixest</h1><p><a href="https://lrberge.github.io/fixest" target="_blank" rel="noopener noreferrer"><strong>fixest</strong><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> (by Laurent Berg√©) is a package designed from the ground up in C++ to make running regressions fast and incredibly easy. It provides in-built support for a variety of linear and non-linear models, as well as regression tables and plotting methods.</p><h2 id="installation" tabindex="-1"><a class="header-anchor" href="#installation" aria-hidden="true">#</a> Installation</h2><p>Before continuing, make sure that you have installed <strong>fixest</strong>. You only have to do this once (or as often as you want to update the package).</p><div class="code--container grid-cols-1"><div><div class="language-r ext-r line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-comment);"># Install from CRAN</span></span>
<span class="line"><span style="color:var(--shiki-token-function);">install.packages</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-string-expression);">&quot;fixest&quot;</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># Alternatively, you can install the latest development version</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># install.packages(&quot;fixest&quot;, repos = &quot;https://fastverse.r-universe.dev&quot;)</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></div></div><p>Once <strong>fixest</strong> is installed, don&#39;t forget to load it whenever you want to use it. Unlike Stata, you have to re-load a package every time you start a new R session.</p><div class="code--container grid-cols-1"><div><div class="language-r ext-r line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-comment);"># Load fixest into our current R session</span></span>
<span class="line"><span style="color:var(--shiki-token-function);">library</span><span style="color:var(--shiki-color-text);">(fixest)</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></div></div><p>All of the examples in this section will use a modified dataset from the CPS with some added variables for demonstration purposes. To load the data run the following:</p><div class="code--container"><div><div class="language-stata ext-stata line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-color-text);">import delimited using </span><span style="color:var(--shiki-token-comment);">///</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-string-expression);">&quot;https://raw.githubusercontent.com/stata2r/stata2r.github.io/main/data/cps_long.csv&quot;</span><span style="color:var(--shiki-color-text);">, </span><span style="color:var(--shiki-token-keyword);">clear</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></div><div><div class="language-r ext-r line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-comment);"># Base R reads CSVs too, but we&#39;ll use data.table here</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">dat </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> data.table</span><span style="color:var(--shiki-token-keyword);">::</span><span style="color:var(--shiki-token-function);">fread(</span><span style="color:var(--shiki-token-string-expression);">&#39;https://raw.githubusercontent.com/stata2r/stata2r.github.io/main/data/cps_long.csv&#39;</span><span style="color:var(--shiki-token-function);">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></div></div><h2 id="introduction" tabindex="-1"><a class="header-anchor" href="#introduction" aria-hidden="true">#</a> Introduction</h2><p>The <a href="https://lrberge.github.io/fixest/index.html" target="_blank" rel="noopener noreferrer"><strong>fixest</strong><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> package contains a highly flexible set of tools that allow you to estimate a fairly large set of standard regression models. While the package certainly doesn&#39;t cover <em>every</em> model that exists, there is a non-negligible subset of Stata users for whom every model they&#39;ve ever needed to run is covered by <strong>fixest</strong>.</p><p>This includes regular ol&#39; linear regression in the <code>feols()</code> function, which builds off of the Base R standard regression function <code>lm(),</code> but also includes things like instrumental variables via 2SLS, and of course support for as many fixed effects as you&#39;d like. <strong>fixest</strong> isn&#39;t limited to linear regression either, covering IV and fixed-effects support for a wide range of GLM models like logit, probit, Poisson, negative binomial, and so on in <code>feglm()</code> and <code>fepois().</code></p><p><strong>fixest</strong> covers all of this while being <em>very</em> fast. If you felt a speed boost going from Stata&#39;s <code>xtreg</code> to <code>reghdfe,</code> get ready for another significant improvement when moving to <strong>fixest</strong>.</p><p>You also get a fair amount of convenience. Adjusting your standard errors to be heteroskedasticity-robust or clustered can be a pain in other R regression functions, but it is easy in <strong>fixest</strong> with the <code>vcov</code> option. Regression tables, coefficient and interaction-margin plots, selecting long lists of controls without having to type them all in, lagged variables, retrieving estimated fixed effects, Wald tests, and the choice of reference for categorical variables are all made easy. You even get some stuff that&#39;s rather tricky in Stata, like automatically iterating over a bunch of model specifications, basic and staggered difference-in-difference support, or Conley standard errors.</p><p>Using <strong>fixest</strong> for regression starts with writing a formula. While there are plenty of bells and whistles to add, at its core regression formulas take the form <strong><code>y ~ x1 + x2 | fe1 + fe2</code></strong>, where <code>y</code> is the outcome, <code>x1</code> and <code>x2</code> are predictors, and <code>fe1</code> and <code>fe2</code> are your sets of fixed effects.</p><h2 id="models" tabindex="-1"><a class="header-anchor" href="#models" aria-hidden="true">#</a> Models</h2><p>Unlike Stata, which only ever has one active dataset in memory, remember that having multiple datasets in your global environment is the norm in R. We highlight this difference to head off a very common error for new Stata R users: <em>you need to specify which dataset you&#39;re using in your model calls</em>, e.g. <code>feols(..., data = dat)</code>. We&#39;ll see lots of examples below. At the same time, note that <strong>fixest</strong> allows you to set various <a href="https://lrberge.github.io/fixest/reference/index.html#section-default-values" target="_blank" rel="noopener noreferrer">global options<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a>, including which dataset you want to use for all of your regressions. Again, we&#39;ll see examples below.</p><h3 id="simple-model" tabindex="-1"><a class="header-anchor" href="#simple-model" aria-hidden="true">#</a> Simple model</h3><div class="code--container"><div><div class="language-stata ext-stata line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-keyword);">reg</span><span style="color:var(--shiki-color-text);"> wage educ </span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">reg</span><span style="color:var(--shiki-color-text);"> wage educ age</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></div><div><div class="language-r ext-r line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ, data </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-token-punctuation);"> dat</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-token-punctuation);"> age, data </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-token-punctuation);"> dat</span><span style="color:var(--shiki-token-function);">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># Aside 1: `data = ...` is always the first argument </span></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># after the model formula. So many R users would just </span></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># write: </span></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ, dat</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># Aside 2: You can also set your dataset globally so </span></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># that you don&#39;t have to reference it each time. </span></span>
<span class="line"><span style="color:var(--shiki-token-function);">setFixest_estimation(</span><span style="color:var(--shiki-token-punctuation);">data </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-token-punctuation);"> dat</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-token-punctuation);"> age</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># etc.</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div></div></div><h3 id="categorical-variables" tabindex="-1"><a class="header-anchor" href="#categorical-variables" aria-hidden="true">#</a> Categorical variables</h3><div class="code--container"><div><div class="language-stata ext-stata line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-keyword);">reg</span><span style="color:var(--shiki-color-text);"> wage educ </span><span style="color:var(--shiki-token-constant);">i.</span><span style="color:var(--shiki-color-text);">treat </span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);">* Specifying a baseline:</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">reg</span><span style="color:var(--shiki-color-text);"> wage educ </span><span style="color:var(--shiki-token-constant);">ib</span><span style="color:var(--shiki-color-text);">1</span><span style="color:var(--shiki-token-constant);">.</span><span style="color:var(--shiki-color-text);">treat</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></div><div><div class="language-r ext-r line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-function);">i(</span><span style="color:var(--shiki-token-punctuation);">treat</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-token-punctuation);">, dat</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># Specifying a baseline:</span></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-function);">i(</span><span style="color:var(--shiki-token-punctuation);">treat, ref </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-constant);">1</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-token-punctuation);">, dat</span><span style="color:var(--shiki-token-function);">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></div></div><h3 id="fixed-effects" tabindex="-1"><a class="header-anchor" href="#fixed-effects" aria-hidden="true">#</a> Fixed effects</h3><div class="code--container"><div><div class="language-stata ext-stata line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-keyword);">reghdfe</span><span style="color:var(--shiki-color-text);"> wage educ, </span><span style="color:var(--shiki-token-function);">absorb</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-parameter);">countyfips</span><span style="color:var(--shiki-color-text);">) </span><span style="color:var(--shiki-token-function);">cluster</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-parameter);">countyfips</span><span style="color:var(--shiki-color-text);">) </span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">reghdfe</span><span style="color:var(--shiki-color-text);"> wage educ, </span><span style="color:var(--shiki-token-function);">absorb</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-parameter);">countyfips</span><span style="color:var(--shiki-color-text);">)  </span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);">* Add more fixed effects... </span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">reghdfe</span><span style="color:var(--shiki-color-text);"> wage educ, </span><span style="color:var(--shiki-token-function);">absorb</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-parameter);">countyfips</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-parameter);">year</span><span style="color:var(--shiki-color-text);">) </span><span style="color:var(--shiki-token-comment);">///</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">                   </span><span style="color:var(--shiki-token-function);">vce</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-parameter);">cluster</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-parameter);">countyfips</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-parameter);">year</span><span style="color:var(--shiki-color-text);">) </span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">reghdfe</span><span style="color:var(--shiki-color-text);"> wage educ, </span><span style="color:var(--shiki-token-function);">absorb</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-parameter);">countyfips</span><span style="color:var(--shiki-token-keyword);">#</span><span style="color:var(--shiki-token-parameter);">year</span><span style="color:var(--shiki-color-text);">) </span><span style="color:var(--shiki-token-comment);">/// </span></span>
<span class="line"><span style="color:var(--shiki-color-text);">                   </span><span style="color:var(--shiki-token-function);">vce</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-parameter);">cluster</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-parameter);">countyfips</span><span style="color:var(--shiki-token-keyword);">#</span><span style="color:var(--shiki-token-parameter);">year</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></div><div><div class="language-r ext-r line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-token-punctuation);"> countyfips, dat</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># Aside: fixest automatically clusters SEs by the first </span></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># fixed effect (if there are any). We&#39;ll get to SEs </span></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># later, but if you just want iid errors for a fixed </span></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># effect model: </span></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-token-punctuation);"> countyfips, dat, vcov </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-string-expression);">&#39;iid&#39;</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># Add more fixed effects... </span></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-token-punctuation);"> countyfips </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-token-punctuation);"> year, </span></span>
<span class="line"><span style="color:var(--shiki-token-punctuation);">      dat, vcov </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);">countyfips </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-token-punctuation);"> year</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-token-punctuation);"> countyfips</span><span style="color:var(--shiki-token-keyword);">^</span><span style="color:var(--shiki-token-punctuation);">year, </span></span>
<span class="line"><span style="color:var(--shiki-token-punctuation);">      dat</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-comment);"># defaults to vcov = ~countyfips^year</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></div></div><h3 id="instrumental-variables" tabindex="-1"><a class="header-anchor" href="#instrumental-variables" aria-hidden="true">#</a> Instrumental variables</h3><div class="code--container"><div><div class="language-stata ext-stata line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-keyword);">ivreg</span><span style="color:var(--shiki-color-text);"> 2sls wage </span><span style="color:var(--shiki-token-keyword);">(</span><span style="color:var(--shiki-color-text);">educ </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> age</span><span style="color:var(--shiki-token-keyword);">)</span><span style="color:var(--shiki-color-text);"> </span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">ivreg</span><span style="color:var(--shiki-color-text);"> 2sls wage marr </span><span style="color:var(--shiki-token-keyword);">(</span><span style="color:var(--shiki-color-text);">educ </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> age</span><span style="color:var(--shiki-token-keyword);">)</span><span style="color:var(--shiki-color-text);"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);">* With fixed effects </span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">ivreghdfe</span><span style="color:var(--shiki-color-text);"> 2sls wage marr </span><span style="color:var(--shiki-token-keyword);">(</span><span style="color:var(--shiki-color-text);">educ </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> age</span><span style="color:var(--shiki-token-keyword);">)</span><span style="color:var(--shiki-color-text);">, </span><span style="color:var(--shiki-token-function);">absorb</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-parameter);">countyfips</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></div><div><div class="language-r ext-r line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-constant);">1</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-token-punctuation);"> educ </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> age, dat</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);">  </span></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> marr </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-token-punctuation);"> educ </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> age, dat</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># With fixed effects (IV 1st stage always comes last) </span></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> marr </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-token-punctuation);"> countyfips </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-token-punctuation);"> educ </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> age, dat</span><span style="color:var(--shiki-token-function);">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></div></div><h3 id="nonlinear-models" tabindex="-1"><a class="header-anchor" href="#nonlinear-models" aria-hidden="true">#</a> Nonlinear models</h3><p>While we don&#39;t really show it here, note that (almost) all of the functionality that this page demonstrates w.r.t. <code>feols()</code> carries over to <strong>fixest&#39;s</strong> non-linear estimation functions too (<code>feglm()</code>, <code>fepois()</code>, etc.). This includes SE adjustment, and so forth.</p><div class="code--container"><div><div class="language-stata ext-stata line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-keyword);">xtset</span><span style="color:var(--shiki-color-text);"> statefips</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">logit</span><span style="color:var(--shiki-color-text);"> marr age black hisp</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);">* Note: Attempting to replicate the feglm() model with fixed</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);">* effects at right using xtlogit or xtprobit leads to </span></span>
<span class="line"><span style="color:var(--shiki-token-comment);">* numerical overflow or matsize issues</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);">ppmlhdfe educ age black hisp, </span><span style="color:var(--shiki-token-function);">absorb</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-parameter);">statefips</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-parameter);">year</span><span style="color:var(--shiki-color-text);">) </span><span style="color:var(--shiki-token-comment);">///</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">	                      </span><span style="color:var(--shiki-token-function);">vce</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-parameter);">cluster</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-parameter);">statefips</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></div><div><div class="language-r ext-r line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-function);">feglm(</span><span style="color:var(--shiki-token-punctuation);">marr </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> age </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-token-punctuation);"> black </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-token-punctuation);"> hisp, </span></span>
<span class="line"><span style="color:var(--shiki-token-punctuation);">      dat, family </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-string-expression);">&#39;logit&#39;</span><span style="color:var(--shiki-token-function);">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># Add fixed effects (probit this time)</span></span>
<span class="line"><span style="color:var(--shiki-token-function);">feglm(</span><span style="color:var(--shiki-token-punctuation);">marr </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> age </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-token-punctuation);"> black </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-token-punctuation);"> hisp </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-token-punctuation);"> statefips </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-token-punctuation);"> year, </span></span>
<span class="line"><span style="color:var(--shiki-token-punctuation);">      dat, family </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-string-expression);">&#39;probit&#39;</span><span style="color:var(--shiki-token-function);">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># fepois() is there for Poisson regression</span></span>
<span class="line"><span style="color:var(--shiki-token-function);">fepois(</span><span style="color:var(--shiki-token-punctuation);">educ </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> age </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-token-punctuation);"> black </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-token-punctuation);"> hisp </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-token-punctuation);"> statefips </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-token-punctuation);"> year, dat</span><span style="color:var(--shiki-token-function);">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></div></div><h3 id="macros-wildcards-and-shortcuts" tabindex="-1"><a class="header-anchor" href="#macros-wildcards-and-shortcuts" aria-hidden="true">#</a> Macros, wildcards and shortcuts</h3><div class="code--container"><div><div class="language-stata ext-stata line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-keyword);">local</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">ctrls</span><span style="color:var(--shiki-color-text);"> age black hisp marr </span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">reg</span><span style="color:var(--shiki-color-text);"> wage educ </span><span style="color:var(--shiki-color-text);">`</span><span style="color:var(--shiki-token-function);">ctrls</span><span style="color:var(--shiki-color-text);">&#39;</span><span style="color:var(--shiki-color-text);"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">reg</span><span style="color:var(--shiki-color-text);"> wage educ x</span><span style="color:var(--shiki-token-keyword);">*</span><span style="color:var(--shiki-color-text);"> </span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">reg</span><span style="color:var(--shiki-color-text);"> wage educ </span><span style="color:var(--shiki-token-keyword);">*</span><span style="color:var(--shiki-color-text);">sp  </span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">reg</span><span style="color:var(--shiki-color-text);"> wage educ </span><span style="color:var(--shiki-token-keyword);">*ac*</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></div><div><div class="language-r ext-r line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-color-text);">ctrls </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">c</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-string-expression);">&quot;age&quot;</span><span style="color:var(--shiki-color-text);">, </span><span style="color:var(--shiki-token-string-expression);">&quot;black&quot;</span><span style="color:var(--shiki-color-text);">, </span><span style="color:var(--shiki-token-string-expression);">&quot;hisp&quot;</span><span style="color:var(--shiki-color-text);">, </span><span style="color:var(--shiki-token-string-expression);">&quot;marr&quot;</span><span style="color:var(--shiki-color-text);">) </span></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-token-punctuation);"> .[ctrls], dat</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-function);">..(</span><span style="color:var(--shiki-token-string-expression);">&#39;^x&#39;</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-token-punctuation);">, dat</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-comment);"># ^ = starts with </span></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-function);">..(</span><span style="color:var(--shiki-token-string-expression);">&#39;sp<!--vuepress-ssr-app-->#39;</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-token-punctuation);">, dat</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-comment);"># $ = ends with </span></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-function);">..(</span><span style="color:var(--shiki-token-string-expression);">&#39;ac&#39;</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-token-punctuation);">, dat</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># Many more macro options. See `?setFixest_fml` and</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># `?setFixest_estimation`. Example (reminder) where </span></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># you set your dataset globally, so you don&#39;t have to </span></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># retype `data = ...` anymore. </span></span>
<span class="line"><span style="color:var(--shiki-token-function);">setFixest_estimation(</span><span style="color:var(--shiki-token-punctuation);">data </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-token-punctuation);"> dat</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-token-punctuation);"> .[ctrls] </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-token-punctuation);"> statefips</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># Etc.</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div></div></div><h3 id="multi-model-estimations-advanced" tabindex="-1"><a class="header-anchor" href="#multi-model-estimations-advanced" aria-hidden="true">#</a> Multi-model estimations (advanced)</h3><p><strong>fixest</strong> supports a variety of <a href="https://lrberge.github.io/fixest/articles/multiple_estimations.html" target="_blank" rel="noopener noreferrer">multi-model<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> capabilities. Not only are these efficient from a coding perspective (you can get away with much less typing), but they are also highly optimized. For example, if you run a multi-model estimation with the same group of fixed-effects then <strong>fixest</strong> will only compute those fixed-effects <em>once</em> for all models. The next group of examples are meant to highlight some specific examples of this functionality. They don&#39;t necessarily have direct Stata equivalents that we are aware of. Moreover, while we don&#39;t show it here, please note that all of these options can be combined (e.g. split sample with stepwise regression). Multi-model objects can also be sent directly to <a href="#presentation">presentation</a> functions like <code>etable()</code> and <code>coefplot()</code>.</p><h4 id="split-sample" tabindex="-1"><a class="header-anchor" href="#split-sample" aria-hidden="true">#</a> Split sample</h4><div class="language-r ext-r line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-comment);">## Separate regressions for hispanic and non-hispanic</span></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-token-punctuation);"> countyfips, dat, split </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);">hisp</span><span style="color:var(--shiki-token-function);">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># As above, but now includes the full sample as a 3rd reg</span></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-token-punctuation);"> countyfips, dat, fsplit </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);">hisp</span><span style="color:var(--shiki-token-function);">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="multiple-dependent-variables" tabindex="-1"><a class="header-anchor" href="#multiple-dependent-variables" aria-hidden="true">#</a> Multiple dependent variables</h4><div class="language-r ext-r line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-comment);"># Regress wage &amp; educ separately on the same dep. vars &amp; FEs</span></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(c</span><span style="color:var(--shiki-token-punctuation);">(wage, educ</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-color-text);"> age </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-color-text);"> marr </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-color-text);"> countyfips </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-color-text);"> year, dat) </span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="stepwise-regression" tabindex="-1"><a class="header-anchor" href="#stepwise-regression" aria-hidden="true">#</a> Stepwise regression</h4><div class="language-r ext-r line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-comment);"># Stepwise. First reg doesn&#39;t include &quot;marr&quot;, second reg</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># doesn&#39;t include &quot;age&quot;</span></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-function);">sw(</span><span style="color:var(--shiki-token-punctuation);">age, marr</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-token-punctuation);">, dat</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># Cumulative stepwise. As above, except now the second reg</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># includes &quot;age&quot;.</span></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-function);">csw(</span><span style="color:var(--shiki-token-punctuation);">age, marr</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-token-punctuation);">, dat</span><span style="color:var(--shiki-token-function);">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># Stepwise operators work in the FE slot too</span></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-function);">csw(</span><span style="color:var(--shiki-token-punctuation);">year, statefips</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-token-punctuation);">, dat</span><span style="color:var(--shiki-token-function);">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># Aside: You have also use &quot;sw0()&quot; and &quot;csw0()&quot;, in which </span></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># case you&#39;ll get an extra regression at the start that </span></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># doesn&#39;t include the stepwise components. </span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h2 id="interactions" tabindex="-1"><a class="header-anchor" href="#interactions" aria-hidden="true">#</a> Interactions</h2><h3 id="interact-continuous-variables" tabindex="-1"><a class="header-anchor" href="#interact-continuous-variables" aria-hidden="true">#</a> Interact continuous variables</h3><div class="code--container"><div><div class="language-stata ext-stata line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-keyword);">reg</span><span style="color:var(--shiki-color-text);"> wage </span><span style="color:var(--shiki-token-constant);">c.</span><span style="color:var(--shiki-color-text);">educ</span><span style="color:var(--shiki-token-keyword);">#</span><span style="color:var(--shiki-token-constant);">c.</span><span style="color:var(--shiki-color-text);">age </span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">reg</span><span style="color:var(--shiki-color-text);"> wage </span><span style="color:var(--shiki-token-constant);">c.</span><span style="color:var(--shiki-color-text);">educ</span><span style="color:var(--shiki-token-keyword);">##</span><span style="color:var(--shiki-token-constant);">c.</span><span style="color:var(--shiki-color-text);">age </span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);">* Polynomials </span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">reg</span><span style="color:var(--shiki-color-text);"> wage </span><span style="color:var(--shiki-token-constant);">c.</span><span style="color:var(--shiki-color-text);">age</span><span style="color:var(--shiki-token-keyword);">#</span><span style="color:var(--shiki-token-constant);">c.</span><span style="color:var(--shiki-color-text);">age </span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">reg</span><span style="color:var(--shiki-color-text);"> wage </span><span style="color:var(--shiki-token-constant);">c.</span><span style="color:var(--shiki-color-text);">age</span><span style="color:var(--shiki-token-keyword);">##</span><span style="color:var(--shiki-token-constant);">c.</span><span style="color:var(--shiki-color-text);">age </span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></div><div><div class="language-r ext-r line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-token-punctuation);">age, dat</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ</span><span style="color:var(--shiki-token-keyword);">*</span><span style="color:var(--shiki-token-punctuation);">age, dat</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># Polynomials </span></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-function);">I</span><span style="color:var(--shiki-token-punctuation);">(age</span><span style="color:var(--shiki-token-keyword);">^</span><span style="color:var(--shiki-token-constant);">2</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);">, dat) </span></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-function);">poly</span><span style="color:var(--shiki-token-punctuation);">(age, </span><span style="color:var(--shiki-token-constant);">2</span><span style="color:var(--shiki-token-punctuation);">, raw </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-constant);">TRUE</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></div></div><h3 id="interact-categorical-variables" tabindex="-1"><a class="header-anchor" href="#interact-categorical-variables" aria-hidden="true">#</a> Interact categorical variables</h3><div class="code--container"><div><div class="language-stata ext-stata line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-keyword);">reg</span><span style="color:var(--shiki-color-text);"> wage </span><span style="color:var(--shiki-token-constant);">i.</span><span style="color:var(--shiki-color-text);">treat</span><span style="color:var(--shiki-token-keyword);">#</span><span style="color:var(--shiki-token-constant);">i.</span><span style="color:var(--shiki-color-text);">hisp </span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">reg</span><span style="color:var(--shiki-color-text);"> wage </span><span style="color:var(--shiki-token-constant);">i.</span><span style="color:var(--shiki-color-text);">treat </span><span style="color:var(--shiki-token-constant);">i.</span><span style="color:var(--shiki-color-text);">treat</span><span style="color:var(--shiki-token-keyword);">#</span><span style="color:var(--shiki-token-constant);">i.</span><span style="color:var(--shiki-color-text);">hisp</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">reg</span><span style="color:var(--shiki-color-text);"> wage </span><span style="color:var(--shiki-token-constant);">i.</span><span style="color:var(--shiki-color-text);">treat</span><span style="color:var(--shiki-token-keyword);">##</span><span style="color:var(--shiki-token-constant);">i.</span><span style="color:var(--shiki-color-text);">hisp</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></div><div><div class="language-r ext-r line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-function);">i(</span><span style="color:var(--shiki-token-punctuation);">treat, i.hisp</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-token-punctuation);">, dat</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># Aside: i() is a fixest-specific shortcut that also </span></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># has synergies with some other fixest functions. But </span></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># base R interaction operators all still work, e.g. </span></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-function);">factor</span><span style="color:var(--shiki-token-punctuation);">(treat</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-token-keyword);">/</span><span style="color:var(--shiki-token-function);">factor</span><span style="color:var(--shiki-color-text);">(hisp), dat) </span></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-function);">factor</span><span style="color:var(--shiki-token-punctuation);">(treat</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-token-keyword);">*</span><span style="color:var(--shiki-token-function);">factor</span><span style="color:var(--shiki-color-text);">(hisp), dat)</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></div></div><h3 id="interact-categorical-with-continuous-variables" tabindex="-1"><a class="header-anchor" href="#interact-categorical-with-continuous-variables" aria-hidden="true">#</a> Interact categorical with continuous variables</h3><div class="code--container"><div><div class="language-stata ext-stata line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-keyword);">reg</span><span style="color:var(--shiki-color-text);"> wage </span><span style="color:var(--shiki-token-constant);">i.</span><span style="color:var(--shiki-color-text);">treat</span><span style="color:var(--shiki-token-keyword);">#</span><span style="color:var(--shiki-token-constant);">c.</span><span style="color:var(--shiki-color-text);">age </span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">reg</span><span style="color:var(--shiki-color-text);"> wage </span><span style="color:var(--shiki-token-constant);">i.</span><span style="color:var(--shiki-color-text);">treat</span><span style="color:var(--shiki-token-keyword);">#</span><span style="color:var(--shiki-token-constant);">c.</span><span style="color:var(--shiki-color-text);">age </span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">reg</span><span style="color:var(--shiki-color-text);"> wage </span><span style="color:var(--shiki-token-constant);">i.</span><span style="color:var(--shiki-color-text);">treat </span><span style="color:var(--shiki-token-constant);">i.</span><span style="color:var(--shiki-color-text);">treat</span><span style="color:var(--shiki-token-keyword);">#</span><span style="color:var(--shiki-token-constant);">c.</span><span style="color:var(--shiki-color-text);">age </span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">reg</span><span style="color:var(--shiki-color-text);"> wage </span><span style="color:var(--shiki-token-constant);">i.</span><span style="color:var(--shiki-color-text);">treat</span><span style="color:var(--shiki-token-keyword);">##</span><span style="color:var(--shiki-token-constant);">c.</span><span style="color:var(--shiki-color-text);">age</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></div><div><div class="language-r ext-r line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-function);">i(</span><span style="color:var(--shiki-token-punctuation);">treat, age</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-token-punctuation);">, dat</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># Aside: i() is a fixest-specific shortcut that also </span></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># has synergies with some other fixest functions. But </span></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># base R interaction operators all still work, e.g. </span></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-function);">factor</span><span style="color:var(--shiki-token-punctuation);">(treat</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);">age, dat) </span></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-function);">factor</span><span style="color:var(--shiki-token-punctuation);">(treat</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-token-keyword);">/</span><span style="color:var(--shiki-color-text);">age, dat) </span></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-function);">factor</span><span style="color:var(--shiki-token-punctuation);">(treat</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-token-keyword);">*</span><span style="color:var(--shiki-color-text);">age, dat)</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></div></div><h3 id="difference-in-differences" tabindex="-1"><a class="header-anchor" href="#difference-in-differences" aria-hidden="true">#</a> Difference-in-differences</h3><p>In addition to the ability to estimate a difference-in-differences design using two-way fixed effects (if the design is appropriate for that; no staggered treatment, for instance), <strong>fixest</strong> offers several other DID-specific tools. The below examples use generic data sets, since the CPS data used in the rest of this page is not appropriate for DID.</p><div class="code--container"><div><div class="language-stata ext-stata line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-comment);">* No immediate Stata equivalent to did_means that we know of,</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);">* although you could replicate much of it by hand with an </span></span>
<span class="line"><span style="color:var(--shiki-token-comment);">* elaborate call to table</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);">* Sun and Abraham can be estimated using the </span></span>
<span class="line"><span style="color:var(--shiki-token-comment);">* eventstudyinteract package on ssc</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></div><div><div class="language-r ext-r line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-comment);"># did_means() provides tables of means, SEs, and treatment/</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># control and pre/post differences for 2x2 DID</span></span>
<span class="line"><span style="color:var(--shiki-token-function);">did_means(</span><span style="color:var(--shiki-token-punctuation);">outcome </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-token-punctuation);"> control </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> treat </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-token-punctuation);"> post</span><span style="color:var(--shiki-token-function);">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># sunab() produces interactions of the type that allow you to</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># estimate the Sun &amp; Abraham model for staggered treatment </span></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># timing, and automatically get average treatment effects for</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># each relative period</span></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">y </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> control </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-function);">sunab(</span><span style="color:var(--shiki-token-punctuation);">year_treated, year</span><span style="color:var(--shiki-token-function);">))</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></div></div><h3 id="interact-fixed-effects" tabindex="-1"><a class="header-anchor" href="#interact-fixed-effects" aria-hidden="true">#</a> Interact fixed effects</h3><div class="code--container"><div><div class="language-stata ext-stata line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-comment);">* Combine fixed effects </span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">reghdfe</span><span style="color:var(--shiki-color-text);"> wage educ, </span><span style="color:var(--shiki-token-function);">absorb</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-parameter);">statefips</span><span style="color:var(--shiki-token-keyword);">#</span><span style="color:var(--shiki-token-parameter);">year</span><span style="color:var(--shiki-color-text);">) </span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);">* Varying slopes (e.g. time trend for each state) </span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">reghdfe</span><span style="color:var(--shiki-color-text);"> wage educ, </span><span style="color:var(--shiki-token-function);">absorb</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-parameter);">statefips</span><span style="color:var(--shiki-token-keyword);">#</span><span style="color:var(--shiki-token-parameter);">c</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-parameter);">year</span><span style="color:var(--shiki-color-text);">) </span><span style="color:var(--shiki-token-comment);">///</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">	           </span><span style="color:var(--shiki-token-function);">vce</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-parameter);">cluster</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-parameter);">statefips</span><span style="color:var(--shiki-token-keyword);">#</span><span style="color:var(--shiki-token-parameter);">c</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-parameter);">year</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></div><div><div class="language-r ext-r line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-comment);"># Combine fixed effects </span></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-token-punctuation);"> statefips</span><span style="color:var(--shiki-token-keyword);">^</span><span style="color:var(--shiki-token-punctuation);">year, dat</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># Varying slopes (e.g. time trend for each state) </span></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-token-punctuation);"> statefips[year], dat</span><span style="color:var(--shiki-token-function);">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></div></div><h2 id="standard-errors" tabindex="-1"><a class="header-anchor" href="#standard-errors" aria-hidden="true">#</a> Standard errors</h2><p>While you can specify standard errors inside the original <strong>fixest</strong> model call (just like Stata), a unique feature of R is that you can adjust errors for an existing model <em>on-the-fly</em>. This has <a href="https://grantmcdermott.com/better-way-adjust-SEs" target="_blank" rel="noopener noreferrer">several benefits<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a>, including being much more efficient since you don&#39;t have to re-estimate your whole model. We&#39;ll try to highlight examples of both approaches below.</p><h3 id="hc" tabindex="-1"><a class="header-anchor" href="#hc" aria-hidden="true">#</a> HC</h3><div class="code--container"><div><div class="language-stata ext-stata line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-keyword);">reg</span><span style="color:var(--shiki-color-text);"> wage educ, </span><span style="color:var(--shiki-token-function);">vce</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-parameter);">robust</span><span style="color:var(--shiki-color-text);">) </span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">reg</span><span style="color:var(--shiki-color-text);"> wage educ, </span><span style="color:var(--shiki-token-function);">vce</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-parameter);">hc3</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></div><div><div class="language-r ext-r line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ, dat, vcov </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-string-expression);">&#39;hc1&#39;</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ, dat, vcov </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-token-punctuation);"> sandwich</span><span style="color:var(--shiki-token-keyword);">::</span><span style="color:var(--shiki-token-punctuation);">vcovHC</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># Note: You can also adjust the SEs of an existing model </span></span>
<span class="line"><span style="color:var(--shiki-color-text);">m </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ, dat</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-comment);"># iid</span></span>
<span class="line"><span style="color:var(--shiki-token-function);">summary</span><span style="color:var(--shiki-color-text);">(m, vcov </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-string-expression);">&#39;hc1&#39;</span><span style="color:var(--shiki-color-text);">)    </span><span style="color:var(--shiki-token-comment);"># switch to HC1</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></div></div><h3 id="hac" tabindex="-1"><a class="header-anchor" href="#hac" aria-hidden="true">#</a> HAC</h3><div class="code--container"><div><div class="language-stata ext-stata line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-keyword);">xtset</span><span style="color:var(--shiki-color-text);"> id year</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">ivreghdfe</span><span style="color:var(--shiki-color-text);"> wage educ, </span><span style="color:var(--shiki-token-function);">bw</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-parameter);">auto</span><span style="color:var(--shiki-color-text);">) </span><span style="color:var(--shiki-token-function);">vce</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-parameter);">robust</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></div><div><div class="language-r ext-r line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">y </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> x, dat, vcov </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-string-expression);">&#39;NW&#39;</span><span style="color:var(--shiki-token-punctuation);">, panel.id </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);">unit </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-token-punctuation);"> time</span><span style="color:var(--shiki-token-function);">)</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># feols(y ~ x, dat, vcov = &#39;NW&#39;) # if panel id already set (see below)</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></div></div><h3 id="clustered" tabindex="-1"><a class="header-anchor" href="#clustered" aria-hidden="true">#</a> Clustered</h3><div class="code--container"><div><div class="language-stata ext-stata line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-keyword);">reghdfe</span><span style="color:var(--shiki-color-text);"> wage educ, </span><span style="color:var(--shiki-token-function);">absorb</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-parameter);">countyfips</span><span style="color:var(--shiki-color-text);">) </span><span style="color:var(--shiki-token-comment);">/// </span></span>
<span class="line"><span style="color:var(--shiki-color-text);">                   </span><span style="color:var(--shiki-token-function);">vce</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-parameter);">cluster</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-parameter);">countyfips</span><span style="color:var(--shiki-color-text);">) </span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);">* Twoway clustering etc. </span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">reghdfe</span><span style="color:var(--shiki-color-text);"> wage educ, </span><span style="color:var(--shiki-token-function);">absorb</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-parameter);">countyfips</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-parameter);">year</span><span style="color:var(--shiki-color-text);">) </span><span style="color:var(--shiki-token-comment);">///</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">                   </span><span style="color:var(--shiki-token-function);">vce</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-parameter);">cluster</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-parameter);">countyfips</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-parameter);">year</span><span style="color:var(--shiki-color-text);">) </span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">reghdfe</span><span style="color:var(--shiki-color-text);"> wage educ, </span><span style="color:var(--shiki-token-function);">absorb</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-parameter);">countyfips</span><span style="color:var(--shiki-token-keyword);">#</span><span style="color:var(--shiki-token-parameter);">year</span><span style="color:var(--shiki-color-text);">) </span><span style="color:var(--shiki-token-comment);">///</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">                   </span><span style="color:var(--shiki-token-function);">vce</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-parameter);">cluster</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-parameter);">countyfips</span><span style="color:var(--shiki-token-keyword);">#</span><span style="color:var(--shiki-token-parameter);">year</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></div><div><div class="language-r ext-r line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-token-punctuation);"> countyfips, dat</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-comment);"># Auto clusters by FE </span></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># feols(wage ~ educ | countyfips, dat, vcov = ~countyfips) # ofc can be explicit too </span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># Twoway clustering etc. </span></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-token-punctuation);"> countyfips </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-token-punctuation);"> year, </span></span>
<span class="line"><span style="color:var(--shiki-token-punctuation);">      dat, vcov </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);">countyfips </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-token-punctuation);"> year</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># feols(wage ~ educ | countyfips + year, </span></span>
<span class="line"><span style="color:var(--shiki-token-comment);">#      dat, vcov = &#39;twoway&#39;) ## same as above</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-token-punctuation);"> countyfips</span><span style="color:var(--shiki-token-keyword);">^</span><span style="color:var(--shiki-token-punctuation);">year, </span></span>
<span class="line"><span style="color:var(--shiki-token-punctuation);">      dat, vcov </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);">countyfips</span><span style="color:var(--shiki-token-keyword);">^</span><span style="color:var(--shiki-token-punctuation);">year</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></div></div><h3 id="conley-standard-errors" tabindex="-1"><a class="header-anchor" href="#conley-standard-errors" aria-hidden="true">#</a> Conley standard errors</h3><div class="code--container"><div><div class="language-stata ext-stata line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-comment);">* See: http://www.trfetzer.com/conley-spatial-hac-errors-with-fixed-effects/</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div></div><div><div class="language-r ext-r line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ, dat, vcov </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-function);">conley(</span><span style="color:var(--shiki-token-string-expression);">&quot;25 mi&quot;</span><span style="color:var(--shiki-token-function);">))</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div></div></div><h3 id="on-the-fly-se-adjustment" tabindex="-1"><a class="header-anchor" href="#on-the-fly-se-adjustment" aria-hidden="true">#</a> On-the-fly SE adjustment</h3><p>We&#39;re belabouring the point now, but one last reminder that you can adjust the standard errors for existing models &quot;on the fly&quot; by passing the <code>vcov = ...</code> argument. There&#39;s no performance penalty, since the adjustment is done instantaneously and it therefore has the virtue of separating the mechanical <em>computation</em> stage of model estimation from the <em>inference</em> stage. As we&#39;ll see below, on-the-fly SE adjustment works for a variety of other <strong>fixest</strong> functions, e.g. <code>etable()</code>. But here is a quick example using <code>summary()</code>:</p><div class="language-r ext-r line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-color-text);">m </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-token-punctuation);"> countyfips </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-token-punctuation);"> year, dat</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span></span>
<span class="line"><span style="color:var(--shiki-color-text);">m                                    </span><span style="color:var(--shiki-token-comment);"># Clustered by countyfips (default)</span></span>
<span class="line"><span style="color:var(--shiki-token-function);">summary</span><span style="color:var(--shiki-color-text);">(m, vcov </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-string-expression);">&#39;iid&#39;</span><span style="color:var(--shiki-color-text);">)             </span><span style="color:var(--shiki-token-comment);"># Switch to iid errors</span></span>
<span class="line"><span style="color:var(--shiki-token-function);">summary</span><span style="color:var(--shiki-color-text);">(m, vcov </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-string-expression);">&#39;twoway&#39;</span><span style="color:var(--shiki-color-text);">)          </span><span style="color:var(--shiki-token-comment);"># Cluster by countyfips and year </span></span>
<span class="line"><span style="color:var(--shiki-token-function);">summary</span><span style="color:var(--shiki-color-text);">(m, vcov </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-color-text);">countyfips</span><span style="color:var(--shiki-token-keyword);">^</span><span style="color:var(--shiki-color-text);">year)  </span><span style="color:var(--shiki-token-comment);"># Cluster by countyfips*year interaction</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="presentation" tabindex="-1"><a class="header-anchor" href="#presentation" aria-hidden="true">#</a> Presentation</h2><h3 id="regression-table" tabindex="-1"><a class="header-anchor" href="#regression-table" aria-hidden="true">#</a> Regression table</h3><div class="code--container"><div><div class="language-stata ext-stata line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-keyword);">reg</span><span style="color:var(--shiki-color-text);"> wage educ age </span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">eststo</span><span style="color:var(--shiki-color-text);"> est1 </span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">esttab</span><span style="color:var(--shiki-color-text);"> est1</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);">* Add second regression</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">reg</span><span style="color:var(--shiki-color-text);"> wage educ age black hisp</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">eststo</span><span style="color:var(--shiki-color-text);"> est2</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">esttab</span><span style="color:var(--shiki-color-text);"> est1 est2</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);">* Export to TeX</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">esttab</span><span style="color:var(--shiki-color-text);"> using </span><span style="color:var(--shiki-token-string-expression);">&quot;regtable.tex&quot;</span><span style="color:var(--shiki-color-text);">, replace </span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></div><div><div class="language-r ext-r line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-color-text);">est1 </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-token-punctuation);"> age, dat</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span></span>
<span class="line"><span style="color:var(--shiki-token-function);">etable(</span><span style="color:var(--shiki-token-punctuation);">est1</span><span style="color:var(--shiki-token-function);">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># Add second regression</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">est2 </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-token-punctuation);"> age </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-token-punctuation);"> black </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-token-punctuation);"> hisp, dat</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span></span>
<span class="line"><span style="color:var(--shiki-token-function);">etable(</span><span style="color:var(--shiki-token-punctuation);">est1, est2</span><span style="color:var(--shiki-token-function);">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># Export to Tex</span></span>
<span class="line"><span style="color:var(--shiki-token-function);">etable(</span><span style="color:var(--shiki-token-punctuation);">est1, est2, file </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-string-expression);">&quot;regtable.tex&quot;</span><span style="color:var(--shiki-token-function);">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></div></div><p><strong>Note:</strong> The <code>etable()</code> function is extremely flexible and includes support for many things that we won&#39;t show you here. See the relevant vignettes for more (<a href="https://lrberge.github.io/fixest/articles/exporting_tables.html" target="_blank" rel="noopener noreferrer">1<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a>, <a href="https://lrberge.github.io/fixest/articles/etable_new_features.html" target="_blank" rel="noopener noreferrer">2<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a>). Below we highlight a few unique features that don&#39;t have direct Stata equivalents. (You could potentially mimic with a loop, but that will require more code and be slower, since your whole model has to be re-estimated each time.)</p><div class="language-r ext-r line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-comment);"># SEs for existing models can be adjusted on-the-fly </span></span>
<span class="line"><span style="color:var(--shiki-token-function);">etable(</span><span style="color:var(--shiki-token-punctuation);">est1, est2, vcov </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-string-expression);">&#39;hc1&#39;</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># Report multiple SEs for the same model </span></span>
<span class="line"><span style="color:var(--shiki-token-function);">etable(</span><span style="color:var(--shiki-token-punctuation);">est1, vcov </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-keyword);">list</span><span style="color:var(--shiki-token-punctuation);">(</span><span style="color:var(--shiki-token-string-expression);">&#39;iid&#39;</span><span style="color:var(--shiki-token-punctuation);">, </span><span style="color:var(--shiki-token-string-expression);">&#39;hc1&#39;</span><span style="color:var(--shiki-token-punctuation);">, </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);">id, </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);">countyfips)</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># Multi-model example: Two dep. vars, stepwise coefs, </span></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># varying slopes, split sample, etc. (18 models in total!)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">est_mult </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">feols(c</span><span style="color:var(--shiki-token-punctuation);">(wage, age</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-color-text);"> educ </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">csw0(</span><span style="color:var(--shiki-token-punctuation);">hisp, black</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-color-text);"> </span></span>
<span class="line"><span style="color:var(--shiki-color-text);">                     statefips[year], </span></span>
<span class="line"><span style="color:var(--shiki-color-text);">                 dat, fsplit </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-color-text);">marr) </span></span>
<span class="line"><span style="color:var(--shiki-token-function);">etable(</span><span style="color:var(--shiki-token-punctuation);">est_mult, vcov </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);">statefips</span><span style="color:var(--shiki-token-keyword);">^</span><span style="color:var(--shiki-token-punctuation);">year</span><span style="color:var(--shiki-token-function);">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="joint-test-of-coefficients" tabindex="-1"><a class="header-anchor" href="#joint-test-of-coefficients" aria-hidden="true">#</a> Joint test of coefficients</h3><div class="code--container"><div><div class="language-stata ext-stata line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-comment);">* Rename so we can use the wildcard later</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">rename</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">(</span><span style="color:var(--shiki-color-text);">black hisp</span><span style="color:var(--shiki-token-keyword);">)</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">(</span><span style="color:var(--shiki-color-text);">raceeth_black raceeth_hisp</span><span style="color:var(--shiki-token-keyword);">)</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">regress</span><span style="color:var(--shiki-color-text);"> wage educ age raceeth_</span><span style="color:var(--shiki-token-keyword);">*</span><span style="color:var(--shiki-color-text);"> marr </span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">testparm</span><span style="color:var(--shiki-color-text);"> raceeth_black raceeth_hisp</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">testparm</span><span style="color:var(--shiki-color-text);"> raceeth_</span><span style="color:var(--shiki-token-keyword);">*</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></div><div><div class="language-r ext-r line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-comment);"># Rename so we can use a regular expression later</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">data.table</span><span style="color:var(--shiki-token-keyword);">::</span><span style="color:var(--shiki-token-function);">setnames(</span><span style="color:var(--shiki-token-punctuation);">dat, </span><span style="color:var(--shiki-token-function);">c</span><span style="color:var(--shiki-token-punctuation);">(</span><span style="color:var(--shiki-token-string-expression);">&#39;black&#39;</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-token-string-expression);">&#39;hisp&#39;</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);">, </span><span style="color:var(--shiki-token-function);">c</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-string-expression);">&#39;raceeth_black&#39;</span><span style="color:var(--shiki-color-text);">,</span><span style="color:var(--shiki-token-string-expression);">&#39;raceeth_hisp&#39;</span><span style="color:var(--shiki-color-text);">))</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">est1 </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-token-punctuation);"> age </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-function);">..(</span><span style="color:var(--shiki-token-string-expression);">&#39;raceeth_&#39;</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-token-punctuation);"> marr, dat</span><span style="color:var(--shiki-token-function);">)</span></span>
<span class="line"><span style="color:var(--shiki-token-function);">wald(</span><span style="color:var(--shiki-token-punctuation);">est1, </span><span style="color:var(--shiki-token-function);">c</span><span style="color:var(--shiki-token-punctuation);">(</span><span style="color:var(--shiki-token-string-expression);">&#39;raceeth_black&#39;</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-token-string-expression);">&#39;raceeth_hisp&#39;</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"><span style="color:var(--shiki-token-function);">wald(</span><span style="color:var(--shiki-token-punctuation);">est1, </span><span style="color:var(--shiki-token-string-expression);">&#39;raceeth_&#39;</span><span style="color:var(--shiki-token-function);">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></div></div><h3 id="coefficient-plot" tabindex="-1"><a class="header-anchor" href="#coefficient-plot" aria-hidden="true">#</a> Coefficient plot</h3><div class="code--container"><div><div class="language-stata ext-stata line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-comment);">* Assume we have est1 and est2 from above </span></span>
<span class="line"><span style="color:var(--shiki-color-text);">coefplot est1 </span></span>
<span class="line"><span style="color:var(--shiki-color-text);">coefplot est1 est2</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></div><div><div class="language-r ext-r line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-comment);"># Assume we have est1 and est2 from above </span></span>
<span class="line"><span style="color:var(--shiki-token-function);">coefplot(</span><span style="color:var(--shiki-token-punctuation);">est1</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span></span>
<span class="line"><span style="color:var(--shiki-token-function);">coefplot(</span><span style="color:var(--shiki-token-keyword);">list</span><span style="color:var(--shiki-token-punctuation);">(est1, est2)</span><span style="color:var(--shiki-token-function);">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></div></div><h3 id="interaction-plot" tabindex="-1"><a class="header-anchor" href="#interaction-plot" aria-hidden="true">#</a> Interaction Plot</h3><div class="code--container"><div><div class="language-stata ext-stata line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-keyword);">regress</span><span style="color:var(--shiki-color-text);"> wage hisp</span><span style="color:var(--shiki-token-keyword);">##</span><span style="color:var(--shiki-token-constant);">c.</span><span style="color:var(--shiki-color-text);">age</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);">* Show how effect differs by group</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">margins hisp, </span><span style="color:var(--shiki-token-function);">dydx</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-parameter);">age</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">marginsplot</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">#</span><span style="color:var(--shiki-color-text);"> Show predictive margins with </span><span style="color:var(--shiki-token-keyword);">an</span><span style="color:var(--shiki-color-text);"> interaction</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">regress</span><span style="color:var(--shiki-color-text);"> wage hisp</span><span style="color:var(--shiki-token-keyword);">##</span><span style="color:var(--shiki-token-constant);">c.</span><span style="color:var(--shiki-color-text);">age</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">margins hisp, </span><span style="color:var(--shiki-token-function);">at</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-parameter);">age</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">(</span><span style="color:var(--shiki-token-constant);">16</span><span style="color:var(--shiki-token-keyword);">(</span><span style="color:var(--shiki-token-constant);">1</span><span style="color:var(--shiki-token-keyword);">)</span><span style="color:var(--shiki-token-constant);">55</span><span style="color:var(--shiki-color-text);">)</span><span style="color:var(--shiki-token-keyword);">)</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);">* The recast here gives a line and error area instead of points and lines</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">marginsplot, </span><span style="color:var(--shiki-token-function);">recast</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-parameter);">line</span><span style="color:var(--shiki-color-text);">) </span><span style="color:var(--shiki-token-function);">recastci</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-parameter);">rarea</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></div><div><div class="language-r ext-r line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-color-text);">est1 </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-function);">i(</span><span style="color:var(--shiki-token-punctuation);">hisp, age</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-token-punctuation);">, dat</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># Show how effect differs by group</span></span>
<span class="line"><span style="color:var(--shiki-token-function);">iplot(</span><span style="color:var(--shiki-token-punctuation);">est1</span><span style="color:var(--shiki-token-function);">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># Show predictive margins with an interaction</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># This requires plot_cap from the marginaleffects package</span></span>
<span class="line"><span style="color:var(--shiki-token-function);">library</span><span style="color:var(--shiki-color-text);">(marginaleffects)</span></span>
<span class="line"><span style="color:var(--shiki-token-function);">plot_cap(</span><span style="color:var(--shiki-token-punctuation);">est1, condition </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-function);">c</span><span style="color:var(--shiki-token-punctuation);">(</span><span style="color:var(--shiki-token-string-expression);">&#39;age&#39;</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-token-string-expression);">&#39;hisp&#39;</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></div></div><h2 id="panel" tabindex="-1"><a class="header-anchor" href="#panel" aria-hidden="true">#</a> Panel</h2><p><strong>Note:</strong> You don&#39;t need to specify your panel variables globally and this functionality is mostly for convenience features associated with time-series operations like leads and lags. You can also use <code>panel(dat, ~ id + var)</code> to do so on-the-fly in your regression call. But Laurent, the <strong>fixest</strong> author, recommends setting the panel ID globally when applicable, so that&#39;s what we do below.</p><h3 id="lag-variables" tabindex="-1"><a class="header-anchor" href="#lag-variables" aria-hidden="true">#</a> Lag variables</h3><div class="code--container"><div><div class="language-stata ext-stata line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-keyword);">xtset</span><span style="color:var(--shiki-color-text);"> id year </span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">reg</span><span style="color:var(--shiki-color-text);"> wage educ l1.wage</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></div><div><div class="language-r ext-r line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-function);">setFixest_estimation(</span><span style="color:var(--shiki-token-punctuation);">panel.id </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);">id</span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-token-punctuation);">year</span><span style="color:var(--shiki-token-function);">)</span></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-function);">l(</span><span style="color:var(--shiki-token-punctuation);">wage, </span><span style="color:var(--shiki-token-constant);">1</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-token-punctuation);">, dat</span><span style="color:var(--shiki-token-function);">)</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);"># feols(wage ~ educ + l(wage, 1), dat, panel.id = ~id+year) # if not set</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></div></div><h3 id="lead-variables" tabindex="-1"><a class="header-anchor" href="#lead-variables" aria-hidden="true">#</a> Lead variables</h3><div class="code--container"><div><div class="language-stata ext-stata line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-keyword);">xtset</span><span style="color:var(--shiki-color-text);"> id year </span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">reg</span><span style="color:var(--shiki-color-text);"> wage educ f1.wage</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></div><div><div class="language-r ext-r line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-comment);"># setFixest_estimation(panel.id = ~id+year) # already set</span></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-function);">f(</span><span style="color:var(--shiki-token-punctuation);">wage, </span><span style="color:var(--shiki-token-constant);">1</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-token-punctuation);">, dat</span><span style="color:var(--shiki-token-function);">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></div></div><h3 id="first-difference" tabindex="-1"><a class="header-anchor" href="#first-difference" aria-hidden="true">#</a> First difference</h3><div class="code--container"><div><div class="language-stata ext-stata line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-keyword);">xtset</span><span style="color:var(--shiki-color-text);"> id year </span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">reg</span><span style="color:var(--shiki-color-text);"> wage educ D.x</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></div><div><div class="language-r ext-r line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-comment);"># setFixest_estimation(panel.id = ~id+year) # already set</span></span>
<span class="line"><span style="color:var(--shiki-token-function);">feols(</span><span style="color:var(--shiki-token-punctuation);">wage </span><span style="color:var(--shiki-token-keyword);">~</span><span style="color:var(--shiki-token-punctuation);"> educ </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-token-punctuation);"> </span><span style="color:var(--shiki-token-function);">d(</span><span style="color:var(--shiki-token-punctuation);">wage</span><span style="color:var(--shiki-token-function);">)</span><span style="color:var(--shiki-token-punctuation);">, dat</span><span style="color:var(--shiki-token-function);">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></div></div><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/stata2r/stata2r.github.io/edit/main/src/fixest/README.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page"><!--[--><!--]--> Edit this page <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><!----></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/data.table/" class="" aria-label="data.table"><!--[--><!--]--> data.table <!--[--><!--]--></a></span><span class="next"><a href="/extras/" class="" aria-label="extras"><!--[--><!--]--> extras <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.25be73f6.js" defer></script>
  </body>
</html>
